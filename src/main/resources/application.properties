spring.application.name=fc-cms

# 数据源配置
spring.datasource.url=${DB_URL:jdbc:mysql://localhost:3306/fc_cms?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true}
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD:password}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA配置
# 使用Hibernate自动探测
# spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=false

# 开启懒加载以加速启动
spring.main.lazy-initialization=true

# 数据库初始化
spring.sql.init.mode=never
spring.sql.init.schema-locations=classpath:schema.sql
spring.sql.init.data-locations=classpath:data.sql
spring.sql.init.encoding=utf-8
spring.sql.init.continue-on-error=false

# Thymeleaf配置
spring.thymeleaf.cache=true
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.mode=HTML

# 静态资源优化与缓存
# 开启资源指纹 (Content Versioning) - 已由 build.js 在构建期处理物理重命名，此处可关闭自动策略以避免冲突
spring.web.resources.chain.strategy.content.enabled=false
# 开启资源链缓存
spring.web.resources.chain.cache=true
# 设置强缓存 (1年)
spring.web.resources.cache.period=31536000
# 允许 HTML 模板中使用指纹后的资源路径 (Thymeleaf @{|...|} 自动支持)

# 404 处理配置
spring.mvc.throw-exception-if-no-handler-found=true
spring.web.resources.add-mappings=true

# 日志配置
logging.level.club.freecity.cms=INFO
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=INFO
logging.level.org.hibernate.orm.jdbc.bind=INFO

# 分页全局配置
spring.data.web.pageable.default-page-size=20
spring.data.web.pageable.max-page-size=100
spring.data.web.pageable.one-indexed-parameters=true

# JWT 配置
# 建议生产环境通过环境变量 APP_JWT_SECRET 覆盖
app.jwt.secret=${APP_JWT_SECRET:PRxPke9vWCgtOSdh6Rldm+49GlKm2sJ9IYXrR03xN1E=}

# CORS 配置
# 生产环境应通过环境变量 APP_CORS_ALLOWED_ORIGINS 覆盖
app.cors.allowed-origins=${APP_CORS_ALLOWED_ORIGINS:https://freecity.club,http://freecity.club,\
    https://www.freecity.club,http://www.freecity.club,\
    https://freecity.club:8443,http://freecity.club:8443,\
    https://www.freecity.club:8443,http://www.freecity.club:8443,\
    https://localhost:8443,http://localhost:8443}

# 多租户配置
app.tenant.base-domain=freecity.club
app.tenant.default-code=admin

# 文件上传配置
app.upload.path=uploads
app.upload.max-size=10MB
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# 邮件配置 (建议生产环境通过环境变量覆盖)
spring.mail.host=${APP_MAIL_HOST:-}
spring.mail.port=${APP_MAIL_PORT:-}
spring.mail.username=${APP_MAIL_USERNAME:-}
spring.mail.password=${APP_MAIL_PASSWORD:-}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.enable=true
spring.mail.default-encoding=UTF-8
